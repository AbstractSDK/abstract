name: CircleCI Wasm Builder

on:
  workflow_dispatch:
  #   pull_request:
  #     types: [closed]
  #   branches:
  #     - "releases/**"
  push:

jobs:
  build:
    runs-on: ubuntu-latest
    # if: github.event.pull_request.merged == true
    steps:
      - name: Tickle CircleCI
        env:
          CCI_TOKEN: ${{ secrets.CCI_TOKEN }}
        run: |
          # if [ "${{ github.event.pull_request.merged }}" = "false" ]; then
            curl -X POST \
            -H "Circle-Token: ${CCI_TOKEN}" \
            -H 'Content-Type: application/json' \
            -H 'Accept: application/json' \
            -d '{
            "branch": "add/circle-ci",
            "parameters": {
              "GHA_Meta": "build_wasms"
            }
          }'\
            https://circleci.com/api/v2/project/gh/AbstractSDK/abstract/pipeline
          # fi
